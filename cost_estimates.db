import sqlite3
import random

# Conectar y crear la DB
conn = sqlite3.connect("cost_estimates.db")
cursor = conn.cursor()

# Crear la tabla
cursor.execute("""
CREATE TABLE IF NOT EXISTS cost_estimates (
    cpt_code TEXT,
    description TEXT,
    state TEXT,
    zip_code TEXT,
    city TEXT,
    county TEXT,
    low_price REAL,
    high_price REAL,
    insurance_price REAL
)
""")

# Lista de 50 estados con ciudades ejemplo
estados_ciudades = {
    "AL": ["Birmingham", "Montgomery", "Mobile"],
    "AK": ["Anchorage", "Fairbanks", "Juneau"],
    "AZ": ["Phoenix", "Tucson", "Mesa"],
    "AR": ["Little Rock", "Fayetteville", "Fort Smith"],
    "CA": ["Los Angeles", "San Francisco", "San Diego"],
    "CO": ["Denver", "Colorado Springs", "Aurora"],
    "CT": ["Hartford", "New Haven", "Stamford"],
    "DE": ["Wilmington", "Dover", "Newark"],
    "FL": ["Miami", "Orlando", "Tampa"],
    "GA": ["Atlanta", "Savannah", "Augusta"],
    "HI": ["Honolulu", "Hilo", "Kailua"],
    "ID": ["Boise", "Idaho Falls", "Caldwell"],
    "IL": ["Chicago", "Aurora", "Naperville"],
    "IN": ["Indianapolis", "Fort Wayne", "Evansville"],
    "IA": ["Des Moines", "Cedar Rapids", "Davenport"],
    "KS": ["Wichita", "Topeka", "Kansas City"],
    "KY": ["Louisville", "Lexington", "Bowling Green"],
    "LA": ["New Orleans", "Baton Rouge", "Shreveport"],
    "ME": ["Portland", "Augusta", "Bangor"],
    "MD": ["Baltimore", "Annapolis", "Frederick"],
    "MA": ["Boston", "Worcester", "Springfield"],
    "MI": ["Detroit", "Grand Rapids", "Lansing"],
    "MN": ["Minneapolis", "St. Paul", "Rochester"],
    "MS": ["Jackson", "Gulfport", "Hattiesburg"],
    "MO": ["Kansas City", "St. Louis", "Springfield"],
    "MT": ["Billings", "Missoula", "Bozeman"],
    "NE": ["Omaha", "Lincoln", "Bellevue"],
    "NV": ["Las Vegas", "Reno", "Henderson"],
    "NH": ["Manchester", "Concord", "Nashua"],
    "NJ": ["Newark", "Jersey City", "Paterson"],
    "NM": ["Albuquerque", "Santa Fe", "Las Cruces"],
    "NY": ["New York", "Buffalo", "Rochester"],
    "NC": ["Charlotte", "Raleigh", "Greensboro"],
    "ND": ["Fargo", "Bismarck", "Grand Forks"],
    "OH": ["Columbus", "Cleveland", "Cincinnati"],
    "OK": ["Oklahoma City", "Tulsa", "Norman"],
    "OR": ["Portland", "Salem", "Eugene"],
    "PA": ["Philadelphia", "Pittsburgh", "Allentown"],
    "RI": ["Providence", "Warwick", "Cranston"],
    "SC": ["Charleston", "Columbia", "Greenville"],
    "SD": ["Sioux Falls", "Rapid City", "Aberdeen"],
    "TN": ["Nashville", "Memphis", "Knoxville"],
    "TX": ["Houston", "Dallas", "Austin"],
    "UT": ["Salt Lake City", "Provo", "Ogden"],
    "VT": ["Burlington", "Montpelier", "Rutland"],
    "VA": ["Virginia Beach", "Richmond", "Norfolk"],
    "WA": ["Seattle", "Spokane", "Tacoma"],
    "WV": ["Charleston", "Huntington", "Morgantown"],
    "WI": ["Milwaukee", "Madison", "Green Bay"],
    "WY": ["Cheyenne", "Casper", "Laramie"]
}

# Procedimientos con rangos de precios base (USD 2026)
procedimientos = [
    ("99213","Consulta médica general", 50, 150),
    ("3310","Root Canal (Tratamiento de conducto)", 700, 1200),
    ("2752","Corona dental", 1000, 2000),
    ("70450","Radiografía de cabeza", 150, 400),
    ("93000","Electrocardiograma", 100, 250),
]

# Función para generar ZIP aleatorio por ciudad
def generar_zip():
    return str(random.randint(10000, 99999))

# Insertar datos
for estado, ciudades in estados_ciudades.items():
    for cpt, desc, min_price, max_price in procedimientos:
        # Crear 3 clínicas locales con precios consistentes
        for i, city in enumerate(ciudades):
            zip_code = generar_zip()
            county = f"{city} County"
            low_price = round(random.uniform(min_price, min_price*1.2), 2)
            high_price = round(random.uniform(max_price*0.9, max_price), 2)
            insurance_price = round(low_price * random.uniform(0.5, 0.85), 2)
            cursor.execute("""
                INSERT INTO cost_estimates (cpt_code, description, state, zip_code, city, county, low_price, high_price, insurance_price)
                VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?)
            """, (cpt, desc, estado, zip_code, city, county, low_price, high_price, insurance_price))

# Guardar y cerrar
conn.commit()
conn.close()
print("✅ cost_estimates.db avanzado creado para los 50 estados listo para Aura")
