<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>AURA by May Roga LLC</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- CSS simple -->
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 0; background: #f8f9fa; }
        header { background: #6c63ff; color: white; padding: 1rem; text-align: center; }
        main { padding: 1rem; max-width: 800px; margin: auto; }
        input, select, button { padding: 0.5rem; margin: 0.3rem 0; width: 100%; }
        button { cursor: pointer; background-color: #6c63ff; color: white; border: none; border-radius: 5px; }
        .btn-group { display: flex; flex-wrap: wrap; gap: 0.5rem; }
        .btn-group button { flex: 1; }
        #resultado { margin-top: 1rem; background: #fff; padding: 1rem; border-radius: 5px; box-shadow: 0 0 5px #aaa; white-space: pre-wrap; }
    </style>
</head>
<body>

<header>
    <h1>AURA - Estimador de Costos Médicos y Dentales</h1>
    <p>Transparencia financiera en salud | May Roga LLC</p>
</header>

<main>

    <!-- Selección de idioma -->
    <label for="lang">Idioma / Language / Kreyòl:</label>
    <select id="lang">
        <option value="es">Español</option>
        <option value="en">English</option>
        <option value="ht">Kreyòl (Haitian Creole)</option>
    </select>

    <!-- Input de búsqueda -->
    <label for="consulta">Procedimiento o código CPT:</label>
    <input type="text" id="consulta" placeholder="Ej. Root Canal, D3330">

    <!-- Input ZIP opcional -->
    <label for="zip_user">ZIP (opcional, para resultados locales):</label>
    <input type="text" id="zip_user" placeholder="Ej. 33167">

    <!-- Botones principales -->
    <div class="btn-group">
        <button onclick="obtenerEstimado('rapido')">Estimado Rápido</button>
        <button onclick="obtenerEstimado('standard')">Estimado Standard</button>
        <button onclick="obtenerEstimado('special')">Estimado Especial</button>
        <button onclick="pagarDonacion()">Donación</button>
    </div>

    <!-- Botones secundarios -->
    <div class="btn-group">
        <button onclick="copiarWhatsApp()">Enviar WhatsApp</button>
        <button onclick="imprimirReporte()">Imprimir</button>
        <button onclick="generarPDF()">Descargar PDF</button>
        <button onclick="borrarCampos()">Borrar</button>
    </div>

    <!-- Resultado -->
    <div id="resultado">Aquí se mostrará tu estimado...</div>

</main>

<!-- ===============================
     JS FUNCIONALIDAD
=============================== -->
<script>
const BASE_URL = "https://aura-iyxa.onrender.com"; // tu main.py desplegado en Render

async function obtenerEstimado(plan) {
    const consulta = document.getElementById("consulta").value;
    const zip_user = document.getElementById("zip_user").value;
    const lang = document.getElementById("lang").value;

    if(!consulta) { alert("Por favor ingresa un procedimiento o CPT."); return; }

    const formData = new FormData();
    formData.append("consulta", consulta);
    formData.append("zip_user", zip_user);
    formData.append("lang", lang);

    const res = await fetch(`${BASE_URL}/estimado`, {
        method: "POST",
        body: formData
    });

    const data = await res.json();
    document.getElementById("resultado").textContent = data.resultado;
}

// ===============================
// STRIPE DONACION
// ===============================
async function pagarDonacion() {
    const formData = new FormData();
    formData.append("plan", "donacion");
    const res = await fetch(`${BASE_URL}/create-checkout-session`, { method: "POST", body: formData });
    const data = await res.json();
    window.open(data.url, "_blank");
}

// ===============================
// BOTONES SECUNDARIOS
// ===============================
function copiarWhatsApp() {
    const txt = document.getElementById("resultado").textContent;
    const phone = "1234567890"; // tu WhatsApp oficial
    const url = `https://wa.me/${phone}?text=${encodeURIComponent(txt)}`;
    window.open(url, "_blank");
}

function imprimirReporte() {
    const contenido = document.getElementById("resultado").innerHTML;
    const w = window.open("", "", "width=800,height=600");
    w.document.write(contenido);
    w.document.close();
    w.print();
}

function generarPDF() {
    alert("Función PDF no implementada en este demo, pero se puede integrar con jsPDF.");
}

function borrarCampos() {
    document.getElementById("consulta").value = "";
    document.getElementById("zip_user").value = "";
    document.getElementById("resultado").textContent = "Aquí se mostrará tu estimado...";
}
</script>

</body>
</html>
